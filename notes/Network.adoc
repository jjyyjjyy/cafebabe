= Computer Network notes
:doctype: book
:icons: font
:source-highlighter: highlightjs
:highlightjs-theme: idea
:sectlinks:
:toc: left
:toclevels: 3
:toc-title: 目录

== 1. 路由

以太网交换机:

 以太网交换机工作在数据链路层, 用于在同一网络中的设备转发以太网帧.

路由器:

 负责不同网络之间的数据包传送.
 路由器通过路由表来确定用于转发数据包的最佳路径.
 当网络向不同IP网络中的设备发送数据包时, 数据包会先被转发到默认网关.

== PDU

|===
| 协议 | PDU | 英文名

| 物理层
| 比特
| bit

| 链路层
| 帧
| frame

| 网络层
| 数据包
| packet

| 传输层
| 数据段
| segment

| 应用层
| 报文
| message
|===

== 2. 数据链路层

=== 2.1. CSMA/CD

`一个站点首先检测网络上正在发送的信号, 并在网络空闲时发送自己的帧.
如果其他站点碰巧同时发送, 则为一次碰撞. 每个站点等待一个随即时间, 然后再次尝试发送.
随后如果再次碰撞, 等待的时间翻倍. 最终, 每个站点会得到机会发送, 或者在尝试一定次数(16)后超时.
`

=== 2.2 Ethernet 2帧格式
. 前导字段(8)
. 目标MAC地(6)
. 源MAC地址(6)
. 协议类型(2)
. 上层协议数据(46-1500)
. FCS(4) 发送和接收由硬件处理

协议类型:

* IPv4 0x0800
* IPv6 0x86dd
* ARP 0x0806
* RARP 0x80length > 1500 ? Ethernet2 : 802.3

=== 2.3 ARP帧格式
`ARP提供网络层地址到硬件地址的映射`

. 目标地址(1.1.1.1)
. 源地址
. 类型(0x0806)
. 硬件类型(Ethernet(1))
. 协议类型(IPv4)
. 硬件地址大小
. 协议地址大小
. Opcode: ARP请求(1)/应答(2)
. 发送方MAC地址
. 发送方IP地址
. 接收方MAC地址
. 接收方IP地址


==  IP
`IP提供了一种尽力而为,无连接的数据包交付服务.`

. 版本(0x0100/0x0110)
. 首部长度(一般为0101)
. Differentiated Service
. Explicit Congestion Notification
. 总长度
. 数据报标识
. 分片标志
. 分片偏移
. 生存期
. 传输层协议类型(17 UDP/6 TCP)
. 头部校验和
. 源IP地址
. 目的IP地址



== Appendix

. 路由器的主要功能和特性是什么？
. 在小型路由网络中，如何将设备连接起来？
. 如何使用CLI配置路由器上的基本设置，以实现两个直连网络之间的路由？
. 如何检验直连到路由器的两个网络之间的连接？
. 在接口之间交换数据包时，路由器使用的封装和解封装的过程是什么？
. 什么是路由器的路径决定功能？
. 直连网络的路由表条目是什么？
. 路由器如何创建直连网络的路由表？
. 路由器如何使用静态路由创建路由表？
. 路由器如何使用动态路由协议创建路由表？
